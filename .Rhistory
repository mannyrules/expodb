library(readr)
drugbank <- read_csv("drugbank/drugbank.csv")
View(drugbank)
library(readr)
hmdbnew <- read_csv("hmdb/hmdbnew.csv")
View(hmdbnew)
library(readr)
hmdbnew <- read_csv("hmdb/hmdbnew.csv")
View(hmdbnew)
library(readr)
dataset <- read_csv(NULL)
View(dataset)
library(readr)
t3dbnew <- read_csv("t3db/t3dbnew.csv")
View(t3dbnew)
library(readr)
compounds <- read_csv("foodb/compounds.csv")
View(compounds)
colnames(compounds)
# foodb
foodb <- read_csv("foodb/compounds.csv")
hmdbt3db <- merge(hmdbnew,t3dbnew,by = 'InChIKey')
colnames(foodb)
colnames(drugbank)
foodbdrug <- merge(foodb, drugbank, by.x = 'moldb_inchikey', by.y = 'Standard InChI Key')
dim(fooddrug)
colnames(foodbdrug)
head(foodb$moldb_inchikey)
class(drugbank)
head(drugbank$`Standard InChI Key`)
foodb$InChIKey <- gsub( "InChIKey=", "", as.character(foodb$moldb_inchikey))
drugbank$InChIKey <- drugbank$`Standard InChI Key`
foodb$InChIKey <- gsub( "InChIKey=", "", as.character(foodb$moldb_inchikey))
foodbdrug <- merge(foodb, drugbank,by = 'InChIKey')
length(unique(foodbdrug$InChIKey))
sum(foodb$InChIKey %in% drugbank$InChIKey)
sum(drugbank$InChIKey %in% foodb$InChIKey)
length(unique(drugbank$InChIKey))
x <- foodbdrug[1:50,]
View(x)
length(unique(foodb$InChIKey))
length(unique(foodb$cas_number))
View(drugbank)
length(unique(drugbank$InChIKey))
sum(unique(drugbank$InChIKey) %in% unique(foodb$InChIKey))
foodbnew <- foodb[unique(foodb$InChIKey),]
drugbanknew <- drugbank[unique(drugbank$InChIKey),]
sum(drugbank$InChIKey %in% foodb$InChIKey)
sum(drugbanknew$InChIKey %in% foodbnew$InChIKey)
sum(foodbnew$InChIKey %in% drugbanknew$InChIKey)
sum(foodb$InChIKey %in% drugbank$InChIKey)
sum(unique(foodbnew$InChIKey) %in% unique(drugbanknew$InChIKey))
head(foodbnew$InChIKey)
drugbanknew <- drugbank[!duplicated(drugbank$InChIKey),]
foodbnew <- foodb[!duplicated(foodb$InChIKey),]
head(foodbnew$InChIKey)
sum(unique(foodbnew$InChIKey) %in% unique(drugbanknew$InChIKey))
foodbdrug <- merge(foodb, drugbank,by = 'InChIKey')
gc()
foodbdrug <- merge(foodbnew, drugbanknew,by = 'InChIKey')
htfd <- merge(hmdbt3db,foodbdrug,by = 'InChIKey')
View(htfd)
library(readr)
# drugbank
drugbank <- read_csv("drugbank/drugbank.csv")
drugbank$InChIKey <- drugbank$`Standard InChI Key`
drugbanknew <- drugbank[!duplicated(drugbank$InChIKey),]
# hmdb
hmdbnew <- read_csv("hmdb/hmdbnew.csv")
# t3db
t3dbnew <- read_csv("t3db/t3dbnew.csv")
# foodb
foodb <- read_csv("foodb/compounds.csv")
foodb$InChIKey <- gsub( "InChIKey=", "", as.character(foodb$moldb_inchikey))
foodbnew <- foodb[!duplicated(foodb$InChIKey),]
hmdbt3db <- merge(hmdbnew,t3dbnew,by = 'InChIKey')
foodbdrug <- merge(foodbnew, drugbanknew,by = 'InChIKey')
htfd <- merge(hmdbt3db,foodbdrug,by = 'InChIKey')
htfd$name.x
# 231
write_csv(htfd,'htfd.csv')
htfd$compound_source
htfd$origin
table(htfd$origin)
table(htfd$logpexp.x)
hist(htfd$logpexp.x)
sum(is.na(htfd$logpexp.x))
sum(is.na(htfd$logpexp.x|htfd$logpexp.y))
# 53
library(eulerr)
v <- euler(c("HMDB" = 114100, "T3DB" = 3673, "fooDB" = 24307,"DrugBank" = 9298, "HMDB&T3DB" = 870, "fooDB&DrugBank" = 898, "HMDB&T3DB&fooDB&DrugBank" = 231))
plot.euler(v, conuts = T, font = 1, cex = 1, alpha = 0.5, legend = T, quantities = T)
v <- euler(c("HMDB" = 114100, "T3DB" = 3673, "fooDB" = 24307,"DrugBank" = 9298, "HMDB&T3DB" = 870, "fooDB&DrugBank" = 898, "HMDB&T3DB&fooDB&DrugBank" = 231))
eulerr:::plot.euler(v, conuts = T, font = 1, cex = 1, alpha = 0.5, legend = T, quantities = T)
?euler
t <- intersect(hmdbnew$InChIKey, foodbnew$InChIKey)
length(intersect(hmdbnew$InChIKey, foodbnew$InChIKey))
# 15657
length(intersect(hmdbnew$InChIKey, drugbanknew$InChIKey))
# 2040
length(intersect(t3dbnew$InChIKey, drugbanknew$InChIKey))
# 2040
length(intersect(t3dbnew$InChIKey, foodbnew$InChIKey))
v <- euler(c("HMDB" = 114100, "T3DB" = 3673, "FooDB" = 24307,"DrugBank" = 9298, "HMDB&T3DB" = 870, "HMDB&FooDB" = 15657,"HMDB&DrugBank" = 2040, "T3DB&FooDB" = 547,"T3DB&DrugBank" = 613,"FooDB&DrugBank" = 898, "HMDB&T3DB&fooDB&DrugBank" = 231))
eulerr:::plot.euler(v, conuts = T, font = 1, cex = 1, alpha = 0.5, legend = T, quantities = T)
v <- euler(c("HMDB" = 114100, "T3DB" = 3673, "FooDB" = 24307,"DrugBank" = 9298, "HMDB&T3DB" = 870, "HMDB&FooDB" = 15657,"HMDB&DrugBank" = 2040, "T3DB&FooDB" = 547,"T3DB&DrugBank" = 613,"FooDB&DrugBank" = 898, "HMDB&T3DB&FooDB&DrugBank" = 231))
eulerr:::plot.euler(v, conuts = T, font = 1, cex = 1, alpha = 0.5, legend = T, quantities = T)
v <- euler(c("HMDB" = 114100, "T3DB" = 3673, "FooDB" = 24307,"DrugBank" = 9298, "HMDB&T3DB" = 870, "HMDB&FooDB" = 15657,"HMDB&DrugBank" = 2040, "T3DB&FooDB" = 547,"T3DB&DrugBank" = 613,"FooDB&DrugBank" = 898, "HMDB&T3DB&FooDB&DrugBank" = 231),shape = 'ellipse')
eulerr:::plot.euler(v, conuts = T, font = 1, cex = 1, alpha = 0.5, legend = T, quantities = T)
list <- list(HMDB=hmdbnew$InChIKey,T3DB = t3dbnew$InChIKey, FooDB = foodbnew$InChIKey, DrugBank = drugbanknew$InChIKey)
v <- euler(list,shape = 'ellipse')
eulerr:::plot.euler(v, conuts = T, font = 1, cex = 1, alpha = 0.5, legend = T, quantities = T)
list <- list(HMDB=unique(hmdbnew$InChIKey),T3DB = unique(t3dbnew$InChIKey), FooDB = foodbnew$InChIKey, DrugBank = drugbanknew$InChIKey)
v <- euler(list,shape = 'ellipse')
eulerr:::plot.euler(v, conuts = T, font = 1, cex = 1, alpha = 0.5, legend = T, quantities = T)
eulerr:::plot.euler(v, conuts = T, font = 1, cex = 1, alpha = 0.5, legend = T, quantities = T)
plot(v)
unique(htfd$InChIKey)
plot(v)
eulerr:::plot.euler(v, conuts = T, font = 1, cex = 1, alpha = 0.5, legend = T, quantities = T)
v <- euler(list,shape = 'ellipse',input = 'union')
eulerr:::plot.euler(v, conuts = T, font = 1, cex = 1, alpha = 0.5, legend = T, quantities = T)
v
v <- euler(list)
eulerr:::plot.euler(v, conuts = T, font = 1, cex = 1, alpha = 0.5, legend = T, quantities = T)
v
euler(list(A = c("a", "ab", "ac", "abc"),
B = c("b", "ab", "bc", "abc"),
C = c("c", "ac", "bc", "abc")))
list <- list(T3DB = unique(t3dbnew$InChIKey), FooDB = foodbnew$InChIKey, DrugBank = drugbanknew$InChIKey)
v <- euler(list)
eulerr:::plot.euler(v, conuts = T, font = 1, cex = 1, alpha = 0.5, legend = T, quantities = T)
v
require(gplots)
library(gplots)
venn(list)
list <- list(HMDB=unique(hmdbnew$InChIKey),T3DB = unique(t3dbnew$InChIKey), FooDB = foodbnew$InChIKey, DrugBank = drugbanknew$InChIKey)
venn(list)
venn(list)
?venn
z <- venn(list)
z
venn(list,col = c('red','grey','blue','green'))
)
venn(list)
venn(list)
install.packages(VennDiagram)
install.packages('VennDiagram')
library(VennDiagram)
?VennDiagram::venn.diagram()
venn.diagram(list)
venn.diagram(list,'htfd')
list
sapply(list, function(x) sum(is.na(x)))
?na.omit
list <- list(HMDB=unique(hmdbnew$InChIKey),T3DB = na.omit(unique(t3dbnew$InChIKey)), FooDB = na.omit(foodbnew$InChIKey), DrugBank = na.omit(drugbanknew$InChIKey))
venn.diagram(list,'htfd.tiff')
library(scales)
show_col(hue_pal()(4))
venn.diagram(list,'htfd.tiff',fill = hue_pal()(4))
venn.diagram(list,'htfd.png',fill = hue_pal()(4),imagetype = 'png')
?hue_pal
?draw.quintuple.venn
venn.plot <- draw.quintuple.venn(
area1 = 301,
area2 = 321,
area3 = 311,
area4 = 321,
area5 = 301,
n12 = 188,
n13 = 191,
n14 = 184,
n15 = 177,
n23 = 194,
n24 = 197,
n25 = 190,
n34 = 190,
n35 = 173,
n45 = 186,
n123 = 112,
n124 = 108,
n125 = 108,
n134 = 111,
n135 = 104,
n145 = 104,
n234 = 111,
n235 = 107,
n245 = 110,
n345 = 100,
n1234 = 61,
n1235 = 60,
n1245 = 59,
n1345 = 58,
n2345 = 57,
n12345 = 31,
category = c("A", "B", "C", "D", "E"),
fill = c("dodgerblue", "goldenrod1", "darkorange1", "seagreen3", "orchid3"),
cat.col = c("dodgerblue", "goldenrod1", "darkorange1", "seagreen3", "orchid3"),
cat.cex = 2,
margin = 0.05,
cex = c(1.5, 1.5, 1.5, 1.5, 1.5, 1, 0.8, 1, 0.8, 1, 0.8, 1, 0.8, 1, 0.8,
1, 0.55, 1, 0.55, 1, 0.55, 1, 0.55, 1, 0.55, 1, 1, 1, 1, 1, 1.5),
ind = TRUE
)
library(readr)
companno <- read_csv("companno.csv")
View(companno)
list <- list(HMDB=unique(hmdbnew$InChIKey),T3DB = na.omit(unique(t3dbnew$InChIKey)), FooDB = na.omit(foodbnew$InChIKey), DrugBank = na.omit(drugbanknew$InChIKey), MSSM = na.omit(companno$InChIKey))
venn.diagram(list,'htfdm.png',fill = hue_pal()(5),imagetype = 'png')
venn.diagram(list,'htfdm.png',fill = hue_pal()(5),imagetype = 'png')
?venn.diagram
venn.diagram(list,'htfdm.png',width = 3500,fill = hue_pal()(5),imagetype = 'png')
venn.diagram(list,'htfdm.png',height = 3500, width = 3500,fill = hue_pal()(5),imagetype = 'png')
venn.diagram(list,'htfdm.png',main.cex = 0.8,fill = hue_pal()(5),imagetype = 'png')
venn.diagram(list,'htfdm.png',main.cex = 0.618,fill = hue_pal()(5),imagetype = 'png')
venn.diagram(list,'htfdm.png',cat.cex = 0.9,fill = hue_pal()(5),imagetype = 'png')
venn.diagram(list,'htfdm.png',cat.cex = 0.5,fill = hue_pal()(5),imagetype = 'png')
venn.diagram(list,'htfdm.png',margin = c(2,2,2,2),fill = hue_pal()(5),imagetype = 'png')
venn.diagram(list,'htfdm.png',margin = c(.2,.2,.2,.2),fill = hue_pal()(5),imagetype = 'png')
venn.diagram(list,'htfdm.png',margin = c(.1,.1,.1,.1),fill = hue_pal()(5),imagetype = 'png')
venn.diagram(list,'htfdm.png',margin = c(.01,.01,.01,.01),fill = hue_pal()(5),imagetype = 'png')
venn.diagram(list,'htfdm.png',margin = c(.05,.05,.05,.05),fill = hue_pal()(5),imagetype = 'png')
omim <- read_csv("hmdb/hmdbomim.csv")
omimt3db <- read_csv("hmdb/t3dbomim.csv")
omimt3db <- read_csv("t3db/t3dbomim.csv")
sum(unique(omim$omimid) %in% unique(omimt3db$omimid))
length(unique(omim$omimid))
# 390
length(unique(omim$accession))
length(unique(omimt3db$omimid))
# 587
length(unique(omimt3db$accession))
library(readr)
hmdbsmpdb <- read_csv("hmdb/hmdbsmpdb.csv")
View(hmdbsmpdb)
library(readr)
hmdbsmpdb <- read_csv("hmdb/hmdbsmpdb.csv")
View(hmdbsmpdb)
t3db <- read_csv("t3db/t3db.csv")
t3db$iupac_name <- gsub( "b'", "", as.character(t3db$iupac_name))
t3db$iupac_name <- gsub( "'$", "", as.character(t3db$iupac_name))
t3db$name <- gsub( "b'", "", as.character(t3db$name))
t3db$name <- gsub( "'$", "", as.character(t3db$name))
t3db$InChIKey <- gsub( "InChIKey=", "", as.character(t3db$InChIKey))
write.csv(t3db[,-c(1:5)],file = 't3dbnew.csv')
g <- strsplit(t3db$omim, "\n")
omim <- data.frame(accession = rep(t3db$accession, lapply(g, length)), omimid = unlist(g))
omim <- omim[complete.cases(omim),]
g <- strsplit(as.character(omim$omimid), " ")
omim2 <- data.frame(accession = rep(omim$accession, lapply(g, length)), omimid = unlist(g))
g <- strsplit(as.character(omim2$omimid), '(?<=.{6})', perl=TRUE)
omim3 <- data.frame(accession = rep(omim2$accession, lapply(g, length)), omimid = unlist(g))
write.csv(omim3,file = 't3dbomim.csv')
t3db$smpdb <- gsub( "^\\[", "", as.character(t3db$smpdb))
t3db$smpdb <- gsub( "]$", "", as.character(t3db$smpdb))
t3db$keggmap <- gsub( "^\\[", "", as.character(t3db$keggmap))
t3db$keggmap <- gsub( "]$", "", as.character(t3db$keggmap))
t3db$categories <- gsub( "^\\[", "", as.character(t3db$categories))
t3db$categories <- gsub( "]$", "", as.character(t3db$categories))
t3db$route_of_exposure <- gsub( "\\(.+\\)", "", as.character(t3db$route_of_exposure))
t3db$route_of_exposure <- gsub( " \\(.+\\)", "", as.character(t3db$route_of_exposure))
t3db$route_of_exposure <- gsub( ", ", ";", as.character(t3db$route_of_exposure))
t3db$route_of_exposure <- gsub("[[:space:]]", "", as.character(t3db$route_of_exposure))
t3db$route_of_exposure <- gsub("and", "", as.character(t3db$route_of_exposure))
t3db$route_of_exposure <- gsub("\\.", "", as.character(t3db$route_of_exposure))
t3db$route_of_exposure <- gsub('"', "", as.character(t3db$route_of_exposure))
t3db$route_of_exposure <- tolower(as.character(t3db$route_of_exposure))
g <- strsplit(t3db$smpdb, ",")
smpdb <- data.frame(accession = rep(t3db$accession, lapply(g, length)), smpdb = unlist(g))
smpdb$smpdb <- gsub( "'", "", as.character(smpdb$smpdb))
smpdb$smpdb <- gsub( " ", "", as.character(smpdb$smpdb))
smpdb <- smpdb[!duplicated(smpdb),]
write.csv(smpdb,file = 't3dbsmpdb.csv')
library(readr)
t3dbsmpdb <- read_csv("t3db/t3dbsmpdb.csv")
View(t3dbsmpdb)
t3dbsmpdb <- read_csv("t3db/t3dbsmpdb.csv")
length(intersect(unique(hmdbsmpdb$smpdb),unique(t3dbsmpdb$smpdb)))
unique(hmdbsmpdb$smpdb)
length(unique(hmdbsmpdb$smpdb))
length(unique(t3dbsmpdb$smpdb))
library(readr)
smpdb_pathways <- read_csv("smpdb_pathways.csv")
View(smpdb_pathways)
install.packages('densityClust')
library(densityClust)
irisDist <- dist(iris[,1:4])
irisClust <- densityClust(irisDist, gaussian=TRUE)
plot(irisClust) # Inspect clustering attributes to define thresholds
irisClust <- findClusters(irisClust, rho=2, delta=2)
plotMDS(irisClust)
split(iris[,5], irisClust$clusters)
install.packages('linkcomm')
vignette(package = 'linkcomm')
vignette(linkcom,package = 'linkcomm')
vignette(linkcomm,package = 'linkcomm')
vignette('linkcomm',package = 'linkcomm')
library(readr)
hpvcasinchikey <- read_csv("hpvcasinchikey.csv")
View(hpvcasinchikey)
hpvcasinchikey <- read_csv("hpvcasinchikey.csv")
library(readr)
companno <- read_csv("companno.csv")
View(companno)
length(intersect(unique(hpvcasinchikey$InChIKey),unique(companno$InChIKey)))
library(readr)
htfd <- read_csv("htfd.csv")
View(htfd)
htfd <- read_csv("htfd.csv")
length(intersect(unique(hpvcasinchikey$InChIKey),unique(htfd$InChIKey)))
list <- list(HTFD=unique(htfd$InChIKey),MSSM = na.omit(unique(companno$InChIKey)), HPV = na.omit(hpvcasinchikey$InChIKey))
library(VennDiagram)
library(scales)
venn.diagram(list,'htfdmhpv.png',fill = hue_pal()(3),imagetype = 'png')
length(hpvcasinchikey$InChIKey)
sum(is.na(hpvcasinchikey$InChIKey))
table(hpvcasinchikey$InChIKey)[order(hpvcasinchikey$InChIKey)]
sum(hpvcasinchikey$InChIKey == '<NA>')
View(hpvcasinchikey)
sum(hpvcasinchikey$InChIKey == 'No result')
View(htfd)
length(unique(htfd$cas_number))
length(unique(hmdbnew$cas_registry_number))
length(unique(hmdbnew$InChIKey))
length(unique(t3dbnew$cas_registry_number))
length(unique(foodbnew$cas_number))
length(unique(drugbanknew$CAS))
install.packages('MPsychoR')
data(Rogers)
library(MPsychoR)
data(Rogers)
data("Rogers_Adolescent")
colnames(Rogers) <- colnames(Rogers_Adolescent) <- 1:26
mynetwork <- EBICglasso(cor_auto(Rogers), nrow(Rogers))
library(qgraph)
install.packages("qgraph")
library(qgraph)
library(networktools)
xfun::pkg_attach('networktools',install = T)
mynetwork <- EBICglasso(cor_auto(Rogers), nrow(Rogers))
myqgraph <- qgraph(mynetwork, layout="spring")
MDSnet(myqgraph, MDSadj=mynetwork)
PCAnet(myqgraph, cormat=cor_auto(Rogers))
EIGENnet(myqgraph)
View(mynetwork)
View(omim)
library(readr)
mssmcas <- read_csv("mssmcas.csv")
View(mssmcas)
sum(mssmcas$CAS == 'No result')
list2 <- list(HTFD=unique(htfd$cas_registry_number.x),MSSM = na.omit(unique(mssmcas$CAS)), HPV = na.omit(hpvcasinchikey$CAS))
venn.diagram(list2,'htfdmhpv2.png',fill = hue_pal()(3),imagetype = 'png')
list2 <- list(HTFD=na.omit(unique(htfd$cas_registry_number.x)),MSSM = na.omit(unique(mssmcas$CAS)), HPV = na.omit(hpvcasinchikey$CAS))
venn.diagram(list2,'htfdmhpv2.png',fill = hue_pal()(3),imagetype = 'png')
hpvcasinchikey <- read_csv("hpvcasinchikey.csv")
library(readr)
hpvcasinchikey <- read_csv("hpvcasinchikey.csv")
companno <- read_csv("companno.csv")
htfd <- read_csv("htfd.csv")
mssmcas <- read_csv("mssmcas.csv")
compannocas <- merge(mssmcas,companno,by = 'InChIKey')
View(compannocas)
compannocas$CAS[compannocas$CAS == 'No result'] <- NA
write_csv(compannocas,'compannocas.csv')
sum(is.na(compannocas$CAS))
library(readxl)
refmet_020418 <- read_excel("refmet_020418.xls")
View(refmet_020418)
# refmet
refmet <- read_excel("refmet_020418.xls")
list <- list(HMDB=unique(hmdbnew$InChIKey),T3DB = na.omit(unique(t3dbnew$InChIKey)), FooDB = na.omit(foodbnew$InChIKey), DrugBank = na.omit(drugbanknew$InChIKey), refmet = na.omit(refmet$inchi_key))
library(VennDiagram)
library(readr)
library(readxl)
# refmet
refmet <- read_excel("refmet_020418.xls")
# drugbank
drugbank <- read_csv("drugbank/drugbank.csv")
drugbank$InChIKey <- drugbank$`Standard InChI Key`
drugbanknew <- drugbank[!duplicated(drugbank$InChIKey),]
# hmdb
hmdbnew <- read_csv("hmdb/hmdbnew.csv")
# t3db
t3dbnew <- read_csv("t3db/t3dbnew.csv")
# foodb
foodb <- read_csv("foodb/compounds.csv")
foodb$InChIKey <- gsub( "InChIKey=", "", as.character(foodb$moldb_inchikey))
foodbnew <- foodb[!duplicated(foodb$InChIKey),]
list <- list(HMDB=unique(hmdbnew$InChIKey),T3DB = na.omit(unique(t3dbnew$InChIKey)), FooDB = na.omit(foodbnew$InChIKey), DrugBank = na.omit(drugbanknew$InChIKey), refmet = na.omit(refmet$inchi_key))
library(VennDiagram)
library(scales)
venn.diagram(list,'htfdr.png',fill = hue_pal()(5),imagetype = 'png')
venn.diagram(list,'htfdr.png',fill = hue_pal()(5),margin = c(.05,.05,.05,.05),imagetype = 'png')
